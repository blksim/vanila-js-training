### 21.1 로그란 무엇인가?
- 트랜잭션 로깅 항목은 다음과 같다.(p563)
  - HTTP 메서드
  - 클라이언트와 서버의 HTTP 버전
  - 요청받은 리소스의 URL
  - 응답의 HTTP 상태 코드
  - 요청과 응답 메시지의 크기(모든 엔터티 본문을 포함) 
  - 트랜잭션이 일어난 시간
  - Refer
- 로그를 분석하면 서버나 프락시의 문제를 찾거나, 마케팅, 청구, 장비 조달 계획 수립에 도움이 된다.

### 21.2 로그 포맷
**일반 로그 포맷**
- 대부분의 상용, 오픈소스 서버가 사용
- 필드 구성은 다음과 같다.
  - remotehost 
  - username
  - auth-username
  - timestamp
  - request-line
  - response-code
  - response-size 
  
**혼합 로그 포맷**
- 아파치 같은 서버들이 지원. 위와 유사하지만 Referer, User-Agent 필드가 추가되었다.

- 넷스케이프 확장 로그 포맷, 넷스케이프 확장 2 로그 포맷, 스퀴드 프락시 로그 포맷은 다음 링크 참조
https://docs.trafficserver.apache.org/en/8.0.x/admin-guide/logging/examples.en.html

### 21.3 적중 계량하기
- 원 서버는 결산을 위해 상세 로그를 저장하지만, 클라이언트와 서버 사이에는 캐시가 있기 때문에 많은 요청이 캐시 처리되고 끝난다.
- 이러한 로그 데이터 유실을 해결하려면 결국 캐시를 파기해야 하는데, 그러면 원 서버와 네트워크의 부하가 가중된다.
- 프락시 캐시는 자체 로그를 유지하므로 서버가 그 로그에 접근할 수 있다면 캐시 파기를 피할 수 있다. 
> RFC 2227에 정의됐던 적중 계량(Hit Metering) 규약은 캐시와 서버가 접근 정보를 공유하고, 사용할 수 있는 캐시 리소스의 양을 제어할 수 있는 몇 가지 기초 기능에 대한 HTTP 확장을 제공한다.
- 적중 계량 확장은 Meter라는 새로운 헤더를 추가했으며 사용량이나 보고에 대한 지시자가 여기에 기술될 수 있다.
